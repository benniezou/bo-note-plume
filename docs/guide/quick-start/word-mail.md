---
title: 邮件合并
icon: material-symbols-light:bookmark-flag-rounded
createTime: 2026/02/11 08:16:30
permalink: /guide/word/mail/
---

## 使用邮件合并批量打印

::: timeline
- 准备数据源
  type=success

  准备一个excel 填写需要打印的数据

- 使用邮件合并
  type=success

  -  邮件 → 选择收件人 → 使用现有列表
  - 选择之前创建的Excel文件
  - 在模板中插入合并域

- 插入照片
  type=danger

  - 在照片位置插入：邮件 → 插入合并域 → 照片路径
  - 按Alt+F9切换到域代码
  - 在路径前添加"INCLUDEPICTURE "
  - 再按Alt+F9切换回来

-  完成合并
   type=warning

   点击完成合并可以编辑每个文档，或者点击合并到PDF，然后打印出来
- 结束
   :::

## 插入照片
`IncludePicture` 域代码用于在 Microsoft Word 文档中动态插入指定的图形文件。其插入的图片会随源文件的更改而自动更新，常用于邮件合并等批量生成带照片文档的场景
### 基本语法
`IncludePicture` 域代码的语法结构如下：

{ `INCLUDEPICTURE` "文件名" [开关] }

- { }必须使用 Ctrl + F9 插入，不能手动输入。这组大括号是域代码的标识。
- "文件名"必需参数，指定要插入的图片文件的完整路径和文件名。如果路径或文件名包含空格，必须用英文双引号括起来。
- [开关]可选参数，用于控制图片的插入方式和显示行为。
### 关键使用要点
- 路径分隔符在域代码中，文件路径中的反斜杠 \ 必须使用反斜杠 \\ 替代。例如："C:\\Users\\Documents\\photo.jpg"。
- 插入域代码不要手动输入大括号。正确的操作是按 Ctrl + F9，然后在生成的大括号内输入域代码。
- 切换显示按 Alt + F9 可以在域代码和域结果（即显示的图片）之间进行切换。
- 更新域：插入或修改域代码后，选中该域并按 F9 键可以手动更新，显示最新的图片内容。在邮件合并后，通常需要全选文档（Ctrl + A）再按 F9 来更新所有图片。
### 常用开关
- `\`：不将图片数据保存在文档中，仅保留链接。这可以显著减小文档文件大小，但要求源图片文件必须始终存在且路径不变。
- `\*`: `MERGEFORMAT`：非常重要。此开关用于保留对插入图片进行的格式修改（如调整大小、环绕方式等）。在邮件合并中，若不使用此开关，手动调整的图片格式在更新域后会丢失。
- `\h`:按段落高度调整图片高度。
- `\`：按段落宽度调整图片宽度。
### 在邮件合并中的应用（核心用例）
这是 `IncludePicture` 域最强大的应用场景，用于为每个人批量生成带个人照片的证件、证书等。

- 准备数据源：在 `Excel` 等数据源中，创建一列（如“照片路径”），为每个人填写其照片文件的完整双反斜杠路径‌（如 C:\\photos\\zhangsan.jpg）。
- ==__在 Word 模板中插入域__==
  - 将光标定位到要插入照片的位置。
  - 插入 `IncludePicture` 域，文件名参数先填一个占位符（如 path）。
  - 按 `Shift + F9` 切换到域代码视图。
  - 将占位符 path 删除，然后通过“邮件”选项卡中的“插入合并域”按钮，选择对应的照片路径字段（如 { MERGEFIELD "照片路径" }）。
  - 最终域代码应类似：{ `INCLUDEPICTURE` "{ `MERGEFIELD` "照片路径" }" \* `MERGEFORMAT` }
  - 按 `Shift + F9` 切换回结果视图。
  - ==__完成合并__==：执行邮件合并操作，生成最终文档。
  - ==__更新所有图片__==：关键一步！全选生成的文档（Ctrl + A），然后按 F9 键，以确保所有 IncludePicture 域都根据各自的数据源路径正确更新为对应的个人照片。

## 文本域基本操作

- ==__插入当前日期__=={ DATE \@ "yyyy年m月d日" } (域名称: DATE, 开关: @ "yyyy年m月d日")
- ==__插入文档总字数__== ：{ `NUMWORDS` } (域名称: `NUMWORDS`)
- ==__插入文档标题__== ：{ `DOCPROPERTY` "Title" } (域名称: `DOCPROPERTY`, 参数: "Title")
- ==__插入页码__== ：{ PAGE } (域名称: PAGE)
- ==__条件显示文本__=={ IF { `NUMWORDS` } > 500 "字数超过500" "字数不足500" } (域名称: IF, 参数: 比较表达式和两个文本结果)

- 操作关键快捷键
- 插入域：Ctrl + F9` (插入一对空的大括号 {})。
- 切换域代码与结果`Alt + F9` (切换整个文档)，`Shift + F9` (切换光标所在的单个域)。
- 更新域：选中域后按 `F9` 键。
